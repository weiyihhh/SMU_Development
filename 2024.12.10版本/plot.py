import numpy as np
import matplotlib.pyplot as plt

# 提供的 Vg 和 Id 数据
Vg_values = [
    0.05, 0.0405, 0.031, 0.0215, 0.012, 0.0025, -0.007, -0.0165, -0.026, -0.0355,
    -0.045, -0.0545, -0.064, -0.0735, -0.083, -0.0925, -0.102, -0.1115, -0.121,
    -0.1305, -0.14, -0.1495, -0.159, -0.1685, -0.178, -0.1875, -0.197, -0.2065,
    -0.216, -0.2255, -0.235, -0.2445, -0.254, -0.2635, -0.273, -0.2825, -0.292,
    -0.3015, -0.311, -0.3205, -0.33, -0.3395, -0.349, -0.3585, -0.368, -0.3775,
    -0.387, -0.3965, -0.406, -0.4155, -0.425, -0.4345, -0.444, -0.4535, -0.463,
    -0.4725, -0.482, -0.4915, -0.501, -0.5105, -0.52, -0.5295, -0.539, -0.5485,
    -0.558, -0.5675, -0.577, -0.5865, -0.596, -0.6055, -0.615, -0.6245, -0.634,
    -0.6435, -0.653, -0.6625, -0.672, -0.6815, -0.691, -0.7005, -0.71, -0.7195,
    -0.729, -0.7385, -0.748, -0.7575, -0.767, -0.7765, -0.786, -0.7955, -0.805,
    -0.8145, -0.824, -0.8335, -0.843, -0.8525, -0.862, -0.8715, -0.881, -0.8905,
    -0.9
]

Id_values = [
    -1.819E-09, -6.712E-10, -7.809E-10, -8.923E-10, -9.386E-10, -1.0867E-09,
    -1.0703E-09, -1.1523E-09, -1.2389E-09, -1.3084E-09, -1.3783E-09, -1.5069E-09,
    -1.6012E-09, -1.7497E-09, -1.8521E-09, -2.0174E-09, -2.2338E-09, -2.4663E-09,
    -2.7222E-09, -2.9979E-09, -3.3712E-09, -3.7533E-09, -3.6819E-09, -3.9759E-09,
    -4.3136E-09, -4.7729E-09, -5.4352E-09, -5.1032E-09, -6.4342E-09, -1.18938E-08,
    -1.29368E-08, -1.6287599999999998E-08, -1.6929399999999997E-08, -2.0505799999999998E-08,
    -2.5056999999999997E-08, -3.2106599999999996E-08, -3.8043E-08, -4.7582599999999995E-08,
    -6.0388799999999988E-08, -7.47432E-08, -9.0103599999999989E-08, -1.0798099999999999E-07,
    -1.3312E-07, -1.6065999999999998E-07, -1.9996E-07, -2.4698E-07, -2.9928E-07,
    -3.657E-07, -4.5198E-07, -5.5462E-07, -6.7648E-07, -8.3074E-07, -1.02242E-06,
    -1.2527E-06, -1.5418000000000002E-06, -1.8894000000000003E-06, -2.3178E-06,
    -2.8519E-06, -3.5053000000000006E-06, -4.3144000000000006E-06, -5.2986E-06,
    -6.5095000000000009E-06, -8.0143E-06, -9.8526000000000012E-06, -1.2106E-05,
    -1.4900000000000001E-05, -1.8316000000000002E-05, -2.2524E-05, -2.7726000000000002E-05,
    -3.4076000000000004E-05, -4.186E-05, -5.153E-05, -6.3300000000000007E-05,
    -7.7848E-05, -9.5596E-05, -0.00011732, -0.00014414, -0.00017674, -0.00021654,
    -0.00026546, -0.0003248, -0.00039688, -0.00048538, -0.00059174, -0.00072042,
    -0.00087708, -0.00106382, -0.0012896, -0.0015578, -0.0018772, -0.0022588,
    -0.0027056, -0.0032312, -0.0038492, -0.0045602, -0.0053816, -0.0063322,
    -0.0074006, -0.008611, -0.0099772, -0.0114772
]

# 提供的 Is 数据
Is_values = [
    -1.51512E-08, -1.51338E-08, -1.50742E-08, -1.50414E-08, -1.496E-08, -1.49022E-08,
    -1.48936E-08, -1.4854E-08, -1.48276E-08, -1.47918E-08, -1.47574E-08, -1.47102E-08,
    -1.46444E-08, -1.45654E-08, -1.44792E-08, -1.43894E-08, -1.4298E-08, -1.41622E-08,
    -1.398E-08, -1.38162E-08, -1.35982E-08, -1.32878E-08, -1.23288E-08, -1.18246E-08,
    -1.13326E-08, -1.06488E-08, -1.28584E-08, -1.37246E-08, -1.37528E-08, -7.9406E-09,
    -9.6076E-09, 2.3E-12, 2.9604E-09, 6.7385E-09, 1.19346E-08, 1.66886E-08, 2.02116E-08,
    3.24967E-08, 5.1616E-08, 5.9112E-08, 7.4886E-08, 7.9761E-08, 8.4871E-08, 8.9226E-08
]

# 设置图形窗口
fig, ax = plt.subplots(figsize=(20, 12), facecolor='lightgray')  # 背景色为浅灰色
ax.set_title("MOSFET Id-Vg Curve with Is", fontsize=20, fontweight='bold')
ax.set_xlabel("Gate-Source Voltage (V)", fontsize=14)
ax.set_ylabel("Drain Current (Id) (A)", fontsize=14)

# 创建右侧y轴
ax2 = ax.twinx()
ax2.set_ylabel("Source Current (Is) (A)", fontsize=14)

# 设置网格和坐标轴样式
ax.grid(True, which='both', axis='both', color='lightgray', linestyle='-', linewidth=0.7)  # 密集网格
ax.set_facecolor('white')  # 背景为白色
ax.tick_params(axis='both', which='major', labelsize=12)
ax2.tick_params(axis='both', which='major', labelsize=12)

# 初始化数据
x_data = []
y_data_id = []  # 用于Id数据
y_data_is = []  # 用于Is数据

# 初始化图形线条，颜色改为橘色和绿色
line_id, = ax.plot([], [], linestyle='-', color='orange', linewidth=1.5)  # Id的橘色线条
line_is, = ax2.plot([], [], linestyle='-', color='blue', linewidth=1.5)  # Is的绿色线条

# 启动交互式绘图
plt.ion()

# 模拟实时数据更新并绘图
def simulate_measurement():
    for i, (Vg, Id) in enumerate(zip(Vg_values, Id_values)):
        # 更新数据
        x_data.append(Vg)
        y_data_id.append(Id)
        #y_data_is.append(Is)

        # 更新图形数据
        line_id.set_data(x_data, y_data_id)  # 更新Id线
        #line_is.set_data(x_data, y_data_is)  # 更新Is线

        # 动态调整X轴和Y轴范围
        ax.set_xlim(min(Vg_values), max(Vg_values))  # 保证X轴显示整个范围
        ax.set_ylim(min(y_data_id) * 1.1, max(y_data_id) * 1.1)  # 动态调整左侧y轴范围
        #ax2.set_ylim(min(y_data_is) * 1.1, max(y_data_is) * 1.1)  # 动态调整右侧y轴范围

        # 刷新图形
        plt.draw()
        plt.pause(0.1)

simulate_measurement()

# 关闭交互模式
plt.ioff()
plt.show()
